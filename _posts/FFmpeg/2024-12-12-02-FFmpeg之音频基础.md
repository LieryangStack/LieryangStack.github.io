---
layout: post
title: 二、FFmpeg——音频基础
categories: FFmpeg
tags: [FFmpeg]
---

## 1 声音基本认识

声音是通过空气或其他介质传播的压力波，自然界中的声音通常是模拟的，音频信号以连续变化的方式表示声音，由振动形成声波。声音的特征即**响度**、**音调**、**音色**。

声波的三要素：频率、振幅和波形。频率代表音调的高低，振幅代表声音音量的大小，波形代表音色。

### 1.1 响度

响度反映声音强弱，物理表示为振幅（Amplitude）

声能 W 即声音在介质中传播时使媒介附加的能量，质点振动动能和质点偏离平衡位置所具有的势能的总和，单位是焦耳(J)。

声强 I 即单位时间内通过垂直于声波传播方向的单位面积的平均声能。声强的单位是瓦/平方米(W/m²)。声强级 SIL（Sound Intensity Level）是以 10-12 W/m² 为参考值，任一声强与其比值的对数乘以 10 记为声强级，单位是分贝(dB)。

声压 P 即声波通过媒质时由振动所产生的压强改变量，单位是帕斯卡(Pa)，通常取声压的均方根值称为有效声压。声压级 SPL（Sound Pressure Level）是以 2×10-5 N/m² 为参考值，任一声压与其比值的对数乘以 20 记为声压级，单位也是分贝(dB)。

![alt text](/assets/FFmpeg/02_AudioBasic/image/image.png)

我们日常所说的分贝指的就是声压级。在自由声场中，某处的声强与该处声压的平方成正比，与介质密度和声速的乘积成反比。

### 1.2 音调

音调对应的客观评价尺度是声波的频率（Frequency）

频率是周期的倒数，表示声音在1秒钟内的周期数，计量单位是赫兹(Hz)，音调的高低是由振动频率决定的，两者成正相关关系。音色决定于谐波频谱，也可以说是声音的波形所确定的。

![alt text](/assets/FFmpeg/02_AudioBasic/image/image-1.png)

其中人耳对 `3kHz~5kHz` 频率的声音最敏感。音频倍速播放时音调一般会随播放速度的变化而变化，在实际应用时会使用音频时域处理技术（时间拉伸或变速不变调）来保持播放音频的音调不变。

## 2 声音在计算机的存储

![alt text](/assets/FFmpeg/02_AudioBasic/image/image-3.png)

音频信号要存入计算机，首先通过硬件设备（如麦克风）采集，将声波信号转换为连续的模拟电信号，再通过 3 个步骤采样（以一定采样率在时域内获取离散信号）、量化（每个采样点幅度的数字化表示）、编码（以一定格式存储采样和量化后的数据）实现信号的数字化，将编码后的音频数据通过声卡驱动进行处理，以便存储或回放。

![alt text](/assets/FFmpeg/02_AudioBasic/image/image-2.png)

最终音频数据以二进制形式保存到计算机存储设备，可以通过网络、串流等方式进行传输。

### 2.1 采样率

每一秒钟所采样的数目称为采样频率或采率，单位为HZ（赫兹）。采样频率越高所能描述的声波频率就越高。

根据奈奎斯特定理，按比声音最高频率高2倍以上的频率对声音进行采样，经过数字化处理之后，人耳听到的声音质量不会被降低。所以采样频率一般为44.1kHz。

- 8khz：电话等使用，对于记录人声已经足够使用。

- 22.05khz：广播使用频率。

- 44.1khz：音频CD。

- 48khz：DVD、数字电视中使用。

- 96khz-192khz：DVD-Audio、蓝光高清等使用。

### 2.2 量化

表示一个样本的二进制的位数，即每个采样点用多少比特表示，在计算机中音频的量化深度一般为4、8、16、32位（bit）等。例如：量化深度为8bit时，每个采样点可以表示256个不同的量化值，而量化深度为16bit时,每个采样点可以表示65536个不同的量化值。量化深度的大小影响到声音的质量，显然，位数越多，量化后的波形越接近原始波形，声音的质量越高，而需要的存储空间也越多，位数越少，声音的质量越低，需要的存储空间越少。CD音质采用的是16 bits，移动通信 8bits。

### 2.3 存储大小

声道数。记录声音时，如果每次生成一个声波数据，称为单声道；每次生成两个声波数据，称为双声道。使用双声道记录声音，能够在一定程度上再现声音的方位，反映人耳的听觉特性。

数字音频存储大小。采样频率、量化深度数越高，声音质量也越高，保存这段声音所用的空间也就越大。立体声（双声道）存储大小是单声道文件的两倍。即：

文件大小（B）=采样频率（Hz）×录音时间（S）×（量化深度/8）×声道数（单声道为1，双声道为2）

录制1分钟采样频率为44.1KHz，量化深度为16位，立体声的声音（CD音质），文件大小为：

44.1×1000×60×(16/8)×2=10584000B≈10.09M

可以看到数字音频信号如果不加压缩地直接进行传送或者存储，将会占用极大的带宽以及磁盘空间，这也是后面讲到的音频要进行压缩的原因。


### 2.4 音频编码

**PCM定义**：PCM 全称 Pulse-Code Modulation,就是脉冲调制编码，是用于将波形表示的模拟音频信号转换为数字1和0表示的数字音频信号，而不压缩也不丢失信息的处理技术。简单来说就是将模拟信号转换成数字信号的方法。

比如：通常自然界的声音可以通过一条曲线在坐标中显示连续的模拟信号表示

![alt text](/assets/FFmpeg/02_AudioBasic/image/image-4.png)

 为了更加容易理解 PCM,选取其中的一个波形，假设这一个波形表示一秒的音频模拟信号。则采样可以如下图所示:

![alt text](/assets/FFmpeg/02_AudioBasic/image/image-5.png)

其中红色的曲线表示原始信号；蓝色垂直线段表示是当前时间点对原始信号的一次采样。

编码就是将每个 sample 数据转换成二进制数据，该数据就是 PCM 数据。PCM 数据可以直接存储在介质上，也可以在经过编解码处理后进行存储或传输。PCM 数据常用量化指标: 采样率、位深、声道数、采样数据是否有符号(有符号的采样数据不能使用无符号的方式播放)、字节序（表示 PCM 数据是用大端存储还是小端存储,通常是小端存储）。 例如: ffmpeg 常见的 PCM 数据格式 s16le,它表示有符号的 16 位小端pcm 数据.

### 2.5 音频压缩编码

上面的PCM编码是音频编码后的裸数据，压缩是为了减小编码后的数据存储空间，那么就应该去掉音频的“冗余信息”，从以下两个方面去衡量哪些数据是冗余的

- 之前提到过，人耳所能察觉的声音信号的频率范围为20Hz-20KHz，除此之外的其它频率人耳无法察觉，都可视为冗余信号

- 当一个强音频信号和一个弱音频信号同时存在时，弱信号会被强信号掩蔽，可视为冗余

压缩通常又被分为有损和无损两种：

![alt text](/assets/FFmpeg/02_AudioBasic/image/image-6.png)

## 参考

[参考1：音视频开发（1）音频基础](https://zhuanlan.zhihu.com/p/682990223)

[参考2：音视频开发入门基础知识（音频入门篇）](https://blog.csdn.net/u010140427/article/details/127609455)

[参考3：音频基础--PCM音频](https://blog.csdn.net/jisuanji111111/article/details/127490926)