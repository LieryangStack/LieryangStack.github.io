---
layout: post
title: 三、GstObject
categories: GStreamer核心对象
tags: [GStreamer]
---

## 1 GstObject基本概念


GstObject为由GStreamer库填充的对象层次树提供了一个root。它目前是GInitiallyUnowned之上的一个简单封装。它是一个<span style="color:red;">抽象类<span>，不能单独使用（不能被实例化）。

GstObject提供了基本的引用计数、父对象功能和锁定。大多数函数只是针对特殊的GStreamer需求进行了扩展，并且可以在其基类GObject中找到相同的名称（例如，g_object_ref变为gst_object_ref）。

由于GstObject派生自GInitiallyUnowned，它还继承了浮动引用。请注意，诸如gst_bin_add和gst_element_add_pad之类的函数会获取浮动引用的所有权。

与GObject实例相比，GstObject添加了一个名称属性。使用gst_object_set_name和gst_object_get_name函数来设置/获取对象的名称。

## 2 继承于GstObject的对象

```c
GObject
    ╰──GInitiallyUnowned
        ╰──GstObject
            ╰──GstAllocator
            ╰──GstBufferPool
            ╰──GstBus
            ╰──GstClock
            ╰──GstControlBinding
            ╰──GstControlSource
            ╰──GstDevice
            ╰──GstDeviceMonitor
            ╰──GstDeviceProvider
            ╰──GstElement
            ╰──GstPad
            ╰──GstPadTemplate
            ╰──GstPlugin
            ╰──GstPluginFeature
            ╰──GstRegistry
            ╰──GstStream
            ╰──GstStreamCollection
            ╰──GstTask
            ╰──GstTaskPool
            ╰──GstTracer
            ╰──GstTracerRecord
```

## 3 GstObject结构体成员

### 3.1 GstObjectClass类结构体

```c
struct _GstObjectClass {
  GInitiallyUnownedClass parent_class;

  const gchar	*path_string_separator; /* 对象路径中使用的分隔符 */

  /* signals */
  void          (*deep_notify)      (GstObject * object, GstObject * orig, GParamSpec * pspec);

  /*< public >*/
  /* virtual methods for subclasses */

  /*< private >*/
  gpointer _gst_reserved[GST_PADDING];
};
```


### 3.2 GstObject实例结构体

```c
struct _GstObject {
  GInitiallyUnowned object;

  /*< public >*/ /* with LOCK */
  GMutex         lock;        /* object LOCK */
  gchar         *name;        /* object name */
  GstObject     *parent;      /* this object's parent, weak ref */
  guint32        flags;

  /*< private >*/
  GList         *control_bindings;  /* List of GstControlBinding */
  guint64        control_rate;
  guint64        last_sync;

  gpointer _gst_reserved;
};
```