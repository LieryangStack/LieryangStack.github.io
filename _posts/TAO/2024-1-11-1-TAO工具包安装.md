---
layout: post
title: 一、TAO工具包安装
categories: TAO
tags: [TAO]
---

## 1 什么是NVIDIA TAO工具套件

NVIDIA TAO工具套件基于TensorFlow和PyTorch构建，是NVIDIA TAO框架的低代码版本的AI框架，便于非专业人士训练模型。

## 2 开始使用

下载包含启动脚本、Jupyter notebooks和配置文件的TAO软件包。TAO支持在Google Colab上使用；如果你想在Colab上尝试，可以跳过这一步，直接滚动到下面的在colab中运行部分。

```sh
wget --content-disposition https://api.ngc.nvidia.com/v2/resources/nvidia/tao/tao-getting-started/versions/5.1.0/zip -O getting_started_v5.1.0.zip
unzip -u getting_started_v5.1.0.zip  -d ./getting_started_v5.1.0 && rm -rf getting_started_v5.1.0.zip && cd ./getting_started_v5.1.0
```

### 2.1 文件层级和概览

TAO工具包的入门资源大致分为两部分。

- **setup**：这些是一组快速启动脚本，用于帮助安装和部署TAO工具包启动器和各种云服务提供商中的TAO工具包API。

- **notebooks**：这些是面向初学者的端到端教程notebooks，帮助您快速上手TAO。这些notebooks安装TAO，下载所需数据，并对各种用例执行TAO命令。

    这些notebooks大致分为以下3类。

    - tao_api_starter_kit：这些是端到端的notebooks，帮助您了解TAO工具包API执行模式支持的功能。api目录下的notebooks直接在REST API级别使用REST API请求工作，而client目录使用TAO客户端CLI与API服务器交互。

    - tao_launcher_starter_kit：该目录包括示例notebooks，指导您完成TAO工具包支持的所有计算机视觉模型的端到端工作流程。您可以使用TAO工具包启动器CLI与工具包交互。

    - tao_data_services：该目录包括示例notebooks，指导您完成TAO工具包中包含的不同数据集操作和注释工具的端到端工作流程。


```sh
setup

   |--> quickstart_launcher.sh
   |--> quickstart_api_bare_metal
   |--> quickstart_api_aws_eks
   |--> quickstart_api_azure_aks
   |--> quickstart_api_gcp_gke

notebooks

   |--> tao_api_starter_kit

      |--> api

            |--> automl
            |--> end2end
            |--> dataset_prepare

      |--> client

            |--> automl
            |--> end2end
            |--> dataset_prepare

   |--> tao_launcher_starter_kit

      |--> dino
      |--> deformable_detr
      |--> classification_pyt
      |--> ocdnet
      |-->  ...

   |--> tao_data_services

      |--> data
      |-->  ...
```

## 3 运行TAO工具包：
TAO工具包以Docker容器或一系列Python轮子的形式提供。您可以通过以下方式之一运行TAO工具包：

- 启动器CLI

- 直接使用容器

- TAO工具包APIs

- Python轮子

### 3.1 Launcher CLI

TAO工具包启动器是一个基于Python的轻量级命令行界面。启动器作为建立在PyTorch和TensorFlow之上的TAO工具包容器的前端。CLI让您不需要知道哪个网络在哪个容器中实现。根据您计划使用的模型，相应的容器会自动启动。

要开始使用启动器，请按照以下说明安装所需的前提软件。

#### 3.1.1 Installing the Pre-requisites

TAO工具包启动器严格是一个只支持Python3的软件包，能够在Python版本>= 3.7上运行。

1. 按照官方说明安装[docker-ce](https://docs.docker.com/engine/install/)(可以参考我Docker部分文章进行安装)。

安装了docker-ce后，按照安装后步骤确保Docker可以无需sudo即可运行。

```sh
# 确保Docker可以无需sudo运行
sudo addgroup --system docker
sudo adduser $USER docker && newgrp docker
sudo groupadd docker && sudo usermod -aG docker $USER
```

2. 按照安装指南安装[nvidia-container-toolkit](https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html)

```sh
# 1 安装 nvidia-container-toolkit
curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \
  && curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \
    sed 's#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g' | \
    sudo tee /etc/apt/sources.list.d/nvidia-container-toolkit.list
sudo apt-get update && sudo apt-get install -y nvidia-container-toolkit
# 2 配置
sudo nvidia-ctk runtime configure --runtime=docker
sudo systemctl restart docker
## 不知道是不是只配置docker就可以
sudo nvidia-ctk runtime configure --runtime=containerd
sudo systemctl restart containerd
```

3. 获取[NGC账户和API密钥](https://catalog.ngc.nvidia.com/?filters=&orderBy=weightPopularDESC&query=)：

    点击右上角 Setup -> Generate API Key
![Alt text](image.png)


4. 命令行使用 `docker login nvcr.io` 登录 `NGC`

    **错误error storing credentials**

![Alt text](image-1.png)

[解放方案：docker login失败：err: exit status 1, Try “pass init“](https://blog.csdn.net/level_code/article/details/125309779)

5. 使用Python >= 3.7配置Python环境

[miniconda安装参考](https://zhuanlan.zhihu.com/p/620155655)



### 3.2 Running from Container

### 3.3 Running TAO Toolkit APIs

### 3.4 Running from Python Wheels













## 参考

[参考：使用 NVIDIA TAO Toolkit 5.0 体验最新的视觉 AI 模型开发工作流程](https://zhuanlan.zhihu.com/p/647126254?utm_id=0)

[参考：什么是TAO以及如何安装和使用TAO](https://blog.csdn.net/xccccz/article/details/122736853)